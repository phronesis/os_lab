# OpenStack 2025.1 All-in-One Installation with Kolla-Ansible on Ubuntu 24.04 LTS

This guide walks through deploying OpenStack **2025.1** (stable/Epoxy release) on a single Ubuntu 24.04 VM using **Kolla-Ansible**. We will set up an All-In-One (AIO) environment in WMware Workstation Pro 17 on Windows Host System with one controller/compute node. All OpenStack services will run in Docker containers orchestrated by Kolla-Ansible. The configuration includes Designate for DNS service with a local Bind9 server.

## 1. Virtual Machine Setup and Networking

Consider disabling Hyper-V on your Windows machine and installing/upgrading VMware Workstation Pro (free) to latest release - this should remove CPU race conditions between virtualization engines.
Type `Turn Windows features on or off` into Windows Search Bar, uncheck **Virtual Machine Platform** and **Windows Hypervisor Platform**, confirm and reboot the system. 
Disable **Core Isolation** in **Windows Security**, if this is allowed in your PC.

Download Ubuntu Server 24.04.x ISO file from official Ubuntu web page. The file is required to create a Lab VM.

Before installation, verify configuration of **Host-only Network** VMware Workstation Pro **Virtual Network Editor**, create this network if necessary:

- **Host-only Network**: Host-only Network, IPv4 Address 10.0.0.1, IPv4 Network Mask 255.255.255.0, DHCP Server disabled. The Network Name will be something like **VMnet1**.

Create a VM with the following specs and network layout:

- in **New Virtual Machine Wizard** select **Custom (advanced)**
- in **Guest Operating System Installation** choose **Installer disk image file (iso)** and select Ubuntu server 24.04.x ISO image
- **Virtual machine name:** `os-epoxy-aio`
- Number of processor set to 8 and number of cores per processor set 1
- Set Memory for the Virtual Machine to exactly 16 GB (16,384 MB)
- in Network Type select **Use network address translation (NAT)**
- Select recommended (default) I/O Controller Type and Disk Type, choose **Create a new virtual disk** and set **Maximum disk size** to 100GB, choose **Store virtual disk as a single file**
- Review settings and uncheck **Power on this virtual machine after creation** and click **Finish**

Modify Virtual Machine Hardware Settings by clicking **Edit virtual machine settings** and:

- click on **Processors** and check all options in **Virtualization engine** to enable *Nested Virtualization*
- Add **Hard Disk**: choose recommended Disk Type, choose **Create a new virtual disk**, set size to 120GB and choose **Store virtual disk as a single file**
- Add **Network Adapter**: choose **Custom: Specific virtual network** and select **VMnet1 (Host-only)**, which you have just created
- Add another **Network Adapter**: choose **NAT: Used to share the host's IP address**
- Remove **USB Controller** and **Sound card** - mandatory!

Start the `os-epoxy-aio` VM and perform a **minimized** installation of Ubuntu Server 24.04 on the VM, use `English` as main language. Configure only first Network Interface with DHCP only, set remaining Network Interfaces to **disabled**, these will get configured later. Install system on 100GB disk (!), disable LVM on root disk, it is not required for the LAB purposes. Configure default user with username **`openstack`** and password of your choice. The course assumes this username in exercises. Set hostname to `controller`. Check `Install OpenSSH server` option, it's required for the LAB. 
After installation and reboot, login as `openstack` and configure the system as follows:

## 2. Prepare Ubuntu Linux

Review the script `prep-linux.sh` in this repo, then execute in VMware Workstation console tab for `os-epoxy-aio`:

```bash
wget "https://raw.githubusercontent.com/kriscelmer/os_lab/refs/heads/main/2025.1%20(Epoxy)/prep-linux.sh"
bash prep-linux.sh
```

Consider taking a snapshot of the Lab VM in VMware Workstation, shutdown the VM before.

## 3. Deploy OpenStack

Review the `deploy-openstack.sh` script in this repo. This step is performed in Windows command prompt window (CMD or Terminal), or in SSH client of choice:

```bash
ssh-keygen -R 10.0.0.11 # remove old keys, if exist
ssh openstack@10.0.0.11 # SSH to Lab VM as user 'openstack'

bash deploy-openstack.sh # at Linux prompt
```
Consider taking a snapshot of the Lab VM in VMware Workstation, shutdown the VM before.

## 4. Configure OpenStack Lab

Review the script `lab-config.sh` in this repo. This step is executed in SSH session to Lab VM:

```bash
bash lab-config.sh
```

Password for user `demo` is `openstack` for both projects.

## 5. Shutdown and snapshot the OpenStack Lab VM